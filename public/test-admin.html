<!DOCTYPE html>
<html>
<head>
  <title>Admin Debug Test</title>
</head>
<body>
  <h1>Admin Debug Test</h1>
  <button onclick="testAdmin()">Test Admin Check</button>
  <pre id="output"></pre>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

  <!-- Firebase Config -->
  <script src="/js/firebase-config.js"></script>

  <script>
    async function testAdmin() {
      const output = document.getElementById('output');
      output.textContent = 'Testing...\n';

      try {
        // Get current user
        const user = auth.currentUser;
        output.textContent += `Current user: ${user ? user.email : 'Not logged in'}\n\n`;

        // Check access data from Firebase
        const snapshot = await database.ref('access').once('value');
        const accessList = snapshot.val();

        output.textContent += 'Firebase /access data:\n';
        output.textContent += JSON.stringify(accessList, null, 2) + '\n\n';

        if (user) {
          // Test isAdmin function
          const adminStatus = await isAdmin(user.email);
          output.textContent += `isAdmin(${user.email}): ${adminStatus}\n\n`;

          // Check localStorage
          output.textContent += 'localStorage.isAdmin: ' + localStorage.getItem('isAdmin') + '\n';
          output.textContent += 'localStorage.userEmail: ' + localStorage.getItem('userEmail') + '\n';
        }
      } catch (error) {
        output.textContent += 'Error: ' + error.toString();
      }
    }
  </script>
</body>
</html>
